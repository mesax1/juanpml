---
import Base from "@/layouts/Base.astro";
import { getCollection } from 'astro:content';
import ProjectCard from "@/components/ProjectCard.astro";
import type { SiteMeta } from "@/types";
import type { CollectionEntry } from 'astro:content';

const meta: SiteMeta = {
  title: "Projects",
  description: "AI Projects of some of my clients.",
  articleDate: undefined,
  ogImage: undefined,
};

const allProjects: CollectionEntry<'projects'>[] = await getCollection('projects', ({ data }) => {
  return data.draft !== true;
});

// Sort projects by the 'order' field in frontmatter, then by title if order is the same or undefined
const sortedProjects = allProjects.sort((a, b) => {
  const orderA = a.data.order ?? Infinity;
  const orderB = b.data.order ?? Infinity;
  if (orderA !== orderB) {
    return orderA - orderB;
  }
  return a.data.title.localeCompare(b.data.title);
});

---

<Base meta={meta}>
  <style>
    .projects-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 1rem;
    }
    .projects-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(380px, 1fr)); /* Slightly wider minimum */
      gap: 2rem; /* Spacing between cards */
      padding-top: 2rem;
      padding-bottom: 2rem;
      align-items: stretch; /* Ensure all cards stretch to same height */
    }
    .page-header {
      text-align: center;
      margin-bottom: 2rem;
      padding-top: 2rem;
    }
    .page-header h1 {
      font-size: 2.5rem; /* Tailwind's text-4xl */
      font-weight: 700; /* Tailwind's font-bold */
      margin-bottom: 0.5rem;
      color: #1a202c;
    }
    .page-header p {
      font-size: 1.125rem; /* Tailwind's text-lg */
      color: #4a5568; /* Tailwind's gray-700 */
      max-width: 700px;
      margin-left: auto;
      margin-right: auto;
      line-height: 1.6;
    }
    
    /* Responsive adjustments */
    @media (max-width: 768px) {
      .projects-grid {
        grid-template-columns: 1fr; /* Single column on mobile */
        gap: 1.5rem;
        padding-top: 1.5rem;
      }
      .page-header {
        padding-top: 1.5rem;
        margin-bottom: 1.5rem;
      }
      .page-header h1 {
        font-size: 2rem; /* Smaller on mobile */
      }
    }
    
    @media (min-width: 769px) and (max-width: 1024px) {
      .projects-grid {
        grid-template-columns: repeat(2, 1fr); /* Two columns on tablet */
      }
    }
    
    @media (min-width: 1025px) {
      .projects-grid {
        grid-template-columns: repeat(3, 1fr); /* Three columns on desktop */
      }
    }
  </style>
  
  <div class="projects-container">
    <div class="page-header">
      <h1>{meta.title}</h1>
      <p>{meta.description}</p>
    </div>
    <div class="projects-grid">
      {sortedProjects.map(project => (
        <ProjectCard project={project} />
      ))}
    </div>
    
    <!-- Main CTA -->
    <div class="flex justify-center my-8 lg:my-12">
      <a 
        href="https://calendar.app.google/VALDzjK7GqCTvYz56" 
        target="_blank" 
        rel="noopener" 
        class="inline-flex items-center justify-center h-12 sm:h-14 px-6 sm:px-8 rounded-lg shadow-xl hover:brightness-110 transition-all bg-gradient-to-r from-accent-one to-accent-two text-bgColor font-semibold text-base sm:text-lg"
        aria-label="Schedule your AI consultation appointment"
      >
        Schedule Your AI Consultation
      </a>
    </div>
  </div>
</Base> 